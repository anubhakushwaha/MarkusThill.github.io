<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<!--<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>-->
<!--<script type="text/x-mathjax-config">MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });</script>-->
<head>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({ TeX: { equationNumbers: {autoNumber: "AMS"} } });</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>
  function resizeIframe(obj) {
    obj.style.height = obj.contentWindow.document.body.scrollHeight + 'px';
  }
</script>

<meta charset="utf-8">
<title>Constructing Agents for Connect-4&#58; Final Considerations &#8211; ML & Stats</title>
<meta name="description" content="Describe your website here.">
<meta name="keywords" content="Connect-4, AI, tree-search, alpha-beta, minimax, transposition tables, opening databases, move ordering, bitboards">



<!-- Open Graph -->
<meta property="og:locale" content="en">
<meta property="og:type" content="article">
<meta property="og:title" content="Constructing Agents for Connect-4&#58; Final Considerations">
<meta property="og:description" content="Describe your website here.">
<meta property="og:url" content="https://MarkusThill.github.io/programming/connect-4-final-considerations/">
<meta property="og:site_name" content="ML & Stats">
<meta property="og:image" content="https://MarkusThill.github.io/images/images/logo.png">





<link rel="canonical" href="https://MarkusThill.github.io/programming/connect-4-final-considerations/">
<link href="https://MarkusThill.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="ML & Stats Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no"/>

<!-- For all browsers -->
<link rel="stylesheet" href="https://MarkusThill.github.io/assets/css/main.css">
<link rel="stylesheet" href="https://MarkusThill.github.io/assets/css/jquery.mmenu.all.css">
<link rel="stylesheet" href="https://MarkusThill.github.io/assets/css/jquery.floating-social-share.min.css">
<!-- Webfonts -->
<link href="//fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script type="text/javascript" src="https://MarkusThill.github.io/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="https://MarkusThill.github.io/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="https://MarkusThill.github.io/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="https://MarkusThill.github.io/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://MarkusThill.github.io/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://MarkusThill.github.io/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://MarkusThill.github.io/images/apple-touch-icon-144x144-precomposed.png">




<!--<link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/dreampulse/computer-modern-web-font/master/fonts.css">-->
<link rel="stylesheet" href="/fonts/cmun-serif.css"></link>

<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Constructing Agents for Connect-4: Final Considerations | ML &amp; Stats</title>
<meta name="generator" content="Jekyll v3.8.6" />
<meta property="og:title" content="Constructing Agents for Connect-4: Final Considerations" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="This post is the 7th part of a series of 7 articles: Constructing Agents for Connect-4: Initial Notes Constructing Agents for Connect-4: Tree Search Algorithms Constructing Agents for Connect-4: Board Representations Constructing Agents for Connect-4: Move Ordering Constructing Agents for Connect-4: Transposition Tables Constructing Agents for Connect-4: Opening Databases Constructing Agents for Connect-4: Final Considerations In this blog post a few additional methods are described which can be used to speed up the tree search for a Connect-4 agent slightly. We begin by looking at how to determine the game theoretical values (true values) of inner nodes of the search tree." />
<meta property="og:description" content="This post is the 7th part of a series of 7 articles: Constructing Agents for Connect-4: Initial Notes Constructing Agents for Connect-4: Tree Search Algorithms Constructing Agents for Connect-4: Board Representations Constructing Agents for Connect-4: Move Ordering Constructing Agents for Connect-4: Transposition Tables Constructing Agents for Connect-4: Opening Databases Constructing Agents for Connect-4: Final Considerations In this blog post a few additional methods are described which can be used to speed up the tree search for a Connect-4 agent slightly. We begin by looking at how to determine the game theoretical values (true values) of inner nodes of the search tree." />
<link rel="canonical" href="https://markusthill.github.io/programming/connect-4-final-considerations/" />
<meta property="og:url" content="https://markusthill.github.io/programming/connect-4-final-considerations/" />
<meta property="og:site_name" content="ML &amp; Stats" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-02-20T20:51:36+01:00" />
<script type="application/ld+json">
{"description":"This post is the 7th part of a series of 7 articles: Constructing Agents for Connect-4: Initial Notes Constructing Agents for Connect-4: Tree Search Algorithms Constructing Agents for Connect-4: Board Representations Constructing Agents for Connect-4: Move Ordering Constructing Agents for Connect-4: Transposition Tables Constructing Agents for Connect-4: Opening Databases Constructing Agents for Connect-4: Final Considerations In this blog post a few additional methods are described which can be used to speed up the tree search for a Connect-4 agent slightly. We begin by looking at how to determine the game theoretical values (true values) of inner nodes of the search tree.","headline":"Constructing Agents for Connect-4: Final Considerations","dateModified":"2018-02-20T20:51:36+01:00","datePublished":"2018-02-20T20:51:36+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://markusthill.github.io/programming/connect-4-final-considerations/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://markusthill.github.io/images/logo.png"}},"url":"https://markusthill.github.io/programming/connect-4-final-considerations/","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="https://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->



<div class="header-menu header-menu-top">
    <ul class="header-item-container">
      <li class="header-item-title header-toggle "><a href="#menu"><h2><i class="fa fa-bars"></i></h2></a></li>
      <li class="header-item-title">
        <a href="https://MarkusThill.github.io/">
          
            <img class="logo" src="https://MarkusThill.github.io/images/logo.png" alt="ML & Stats">
          
          <a href="https://MarkusThill.github.io/" class="title"> ML & Stats</a>
        </a>
      </li>
      
        
        

        
            
                <li class="header-item "><a href="https://MarkusThill.github.io/posts"><h3>Posts</h3></a></li>
            
        
      
        
        

        
          <li class="header-item "><a href="https://MarkusThill.github.io/categories"><h3>Categories</h3></a>
            <ul class="header-submenu">
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Electronics">Electronics</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#ML">ML</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Math">Math</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Programming">Programming</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Stats">Stats</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Template">Template</a></li>
              
                
                  <li class="sub-item"><a href="https://MarkusThill.github.io/categories/#Vector Algebra">Vector Algebra</a></li>
              
            </ul>
          </li>
        
      
        
        

        
            
                <li class="header-item "><a href="https://MarkusThill.github.io/tags"><h3>Tags</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://MarkusThill.github.io/markus"><h3>About</h3></a></li>
            
        
      
        
        

        
            
                <li class="header-item "><a href="https://MarkusThill.github.io/"><h3>Home</h3></a></li>
            
        
      
      <li class="header-item"><a href="https://MarkusThill.github.io/search"><h3><i class="fa fa-search"></i></h3></a></li>
    </ul>
  </div>
<div class="entry-header">
  <div class="header-title">
    <div class="header-title-wrap">
      <h1>Constructing Agents for Connect-4&#58; Final Considerations</h1>
      
        <h2><span class="entry-date date published updated"><time datetime="2018-02-20T20:51:36+01:00">February 20, 2018</time></span></h2>
      

      
        <p class="entry-reading-time">
          <i class="fa fa-clock-o"></i>
          
          Reading time ~8 minutes
        </p><!-- /.entry-reading-time -->
      
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->


<nav id="menu" style="display: none">
  <ul>
    
      
        <li><a href="https://MarkusThill.github.io/"><h3>Home</h3></a></li>
      
    
      
        <li><a href="https://MarkusThill.github.io/markus"><h3>About</h3></a></li>
      
    
      
        <li><a href="https://MarkusThill.github.io/tags"><h3>Tags</h3></a></li>
      
    
      
        <li><a href="https://MarkusThill.github.io/categories"><h3>Categories</h3></a>
          <ul>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Electronics">Electronics</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#ML">ML</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Math">Math</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Programming">Programming</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Stats">Stats</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Template">Template</a></li>
            
              
                <li><a href="https://MarkusThill.github.io/categories/#Vector Algebra">Vector Algebra</a></li>
            
          </ul>
        </li>
      
    
      
        <li><a href="https://MarkusThill.github.io/posts"><h3>Posts</h3></a></li>
      
    
  </ul>
</nav>




<div id="main" role="main">
  <article class="hentry">
    <div class="entry-content">
        
      <h1 class="post-title entry-title">Constructing Agents for Connect-4&#58; Final Considerations</h1>
      <p>This post is the 7th part of a series of 7 articles:</p>
<ol>
  <li><a href="/programming/connect-4-introduction-and-tree-search-algorithms/">Constructing Agents for Connect-4: Initial Notes</a></li>
  <li><a href="/programming/connect-4-tree-search-algorithms/">Constructing Agents for Connect-4: Tree Search Algorithms</a></li>
  <li><a href="/programming/connect-4-board-representations/">Constructing Agents for Connect-4: Board Representations</a></li>
  <li><a href="/programming/connect-4-move-ordering/">Constructing Agents for Connect-4: Move Ordering</a></li>
  <li><a href="/programming/connect-4-transposition-tables/">Constructing Agents for Connect-4: Transposition Tables</a></li>
  <li><a href="/programming/connect-4-opening-databases/">Constructing Agents for Connect-4: Opening Databases</a></li>
  <li><strong><a href="/programming/connect-4-final-considerations/">Constructing Agents for Connect-4: Final Considerations</a></strong></li>
</ol>

<p>In this blog post a few additional methods are described which can be used to speed up the tree search for a Connect-4 agent slightly. We begin by looking at how to determine the game theoretical values (true values) of inner nodes of the search tree.</p>

<!--more-->

<div class="alert">
  <!--<span class="closebtn" onclick="this.parentElement.style.display='none';">&times;</span>-->
  <i class="fa fa-info-circle"></i><strong> &nbsp;&nbsp;Note:</strong> The related Java framework for <em>Connect-4</em> is available on GitHub and can be downloaded from: <a href="http://github.com/MarkusThill/Connect-Four">http://github.com/MarkusThill/Connect-Four</a>.
</div>

<h1 id="determination-of-the-game-theoretical-values-of-inner-nodes">Determination of the Game Theoretical Values of Inner Nodes</h1>

<p>Many situations of the Connect-4 game allow a player to immediately put the opponent in an impasse situation, so that the game can be won in the next turn. This is comparable to the formation of a double mill during a Nine-Mens-Morris game. If one of the two players has a double mill, he can open another one by closing a mill at the same time, so that the opponent’s checkers can often be decimated very quickly. However, the creation of a mill, unlike Connect-4, does not mean the immediate defeat of the opponent. Typically, in the Connect-4 game, there are three types of winning positions:</p>

<ol>
  <li>At the end of the game, situations often arise in which one player can only draw under the threat of the opponent and then loses the game (compulsory move).</li>
  <li>In some cases, one of the opponents succeeds in creating two immediate threats with a ply. However, the opponent can only neutralize one of these two immediate threats and has thus lost.</li>
  <li>If a column contains two threats of a player - which are the same on top of each other - the player in question only has to draw under the first threat to win the game.</li>
</ol>

<p>Since the first point relates to the leaf nodes anyway, only the observation of the last two points is of interest here. Such situations can often only be detected late in the simple tree search, since move ordering often prefers other moves at first. For this reason, every move in the program, even before the individual subtrees are expanded, is checked to see whether it can create a situation according to point 2 or 3. If this is the case, the node in question does not need to be examined any further, since an exact evaluation of the position is already available. The examination of positions according to the above-mentioned criteria is relatively time-consuming, so that an application only within root-near nodes is possible. Nevertheless, this measure helps to avoid the complete analysis of numerous subtrees and thus considerably accelerates the search (by approx. 20%).
A further, albeit minimal, improvement  is achieved by interrupting the search whenever there are 40 stones on the board, since it is already possible to make an exact statement about the outcome of the game.</p>

<h1 id="evaluation-of-a-position-at-the-search-horizon">Evaluation of a Position at the Search Horizon</h1>

<p>Positions for simple games such as Tic Tac Toe can be analyzed with the help of a tree search without any particular problems, as the game tree can be expanded up to the leaves.
With a much greater complexity, as is the case with Connect-4 for example, this is no longer possible without further effort. In this case, the search depth must often be limited to an acceptable value. If the search reaches the horizon, a function is required that can estimate the game theoretical value of the current game state. However, the assessment is usually not trivial, since on the one hand a high quality of the evaluation function is expected. On the other hand, this must be done with a reasonable time in order to avoid further unnecessary restrictions on the depth of the search. In order to solve this conflict of objectives, a high degree of creativity and very detailed knowledge of the game in question is necessary, so that the relevant characteristics of a position can be identified and evaluated appropriately.
In contrast to chess (or other games), it is possible to analyze the game Connect-4, even if with a very large amount of programming effort, up to the terminal nodes of the game tree. The techniques and tools used for this have been described in detail in the previous blog posts.
For this reason, no particular importance is attached to static position evaluation at the search horizon in this work, since only a perfect tree search is required as a comparison option for TD-Learning. Nevertheless, a few ideas should be briefly described which resulted in a compact evaluation function.
First of all, you must identify the characteristics to be assessed. While the material ratio plays an important role in chess, the number of threats of both players and their arrangement is of particular importance for Connect-4. Further characteristics, such as the positioning of individual stones, are conceivable, but were not examined further in the context of this work.
In the first part of the evaluation, therefore, all threats from the players are first determined. Subsequently, a heuristic examines the arrangement of threats and estimates the probable game-theoretical value. For positions with less than three threats, this step can be performed very quickly with a few bit-wise operations and some branching. This applies to approx. 70% of the examined game positions. However, if there are more threats, a higher effort is required to determine a prediction. Details can be found in the source code (c4.AlphaBetaAgent.evaluate).</p>

<h1 id="verification-and-runtime-measurement">Verification and Runtime Measurement</h1>
<p>In the course of the project, the Alpha-Beta search with all its extensions and improvements has reached an enormous scope. At the time of the documentation, the source code contained nearly 7000 lines of code, some parts of which were generated automatically. Many of the methods used are limited to specific situations during the search. The correctness of the search in combination with the additional procedures and techniques can therefore not be checked easily. The examination of a few positions is not meaningful enough for this.
Changes to the source code can often have a positive effect on runtime performance in many situations, but not in others. Therefore, it is often not possible to make a statement about whether a modification actually causes a speeding-up, even if significant node savings can be observed.  For this reason, it was decided to carry out more extensive tests. Since John Tromp’s 8-Ply opening database was created independently of this project, it is particularly useful for comparison. During the verification, the test routine of the database takes 2000 entries in each run and compares them with the results of the alpha-beta search (which, of course, does not use opening books). If the runtime of the search is also measured at the same time, the test routine uses the same database entries for each run in order to make comparisons possible. In the current version, the search on a Pentium4 computer takes an average of about 1.7 seconds for positions consisting of eight checkers (size of the transposition tables: 25 MB).
Searching from the empty board takes about 3.5 minutes to find out that the move into the middle column is the best possible (size of the transposition tables: 50 MB). This seems to be a comparatively good time. Some of the best-known Connect-4 programs need almost 17-24 hours for this finding (without opening books and with much larger hash tables).</p>

<h1 id="appendix">Appendix</h1>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/MarkusThill/Connect-Four/blob/master/CFour/src/c4/AlphaBetaAgent.java">This Github Sample</a> is by <a href="https://github.com/MarkusThill">MarkusThill</a>
  </div>
  <div class="meta-info">
    CFour/src/c4/AlphaBetaAgent.java <a href="https://github.com/MarkusThill/Connect-Four/blob/master/CFour/src/c4/AlphaBetaAgent.java">view</a> <a href="https://raw.githubusercontent.com/MarkusThill/Connect-Four/master/CFour/src/c4/AlphaBetaAgent.java">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="cm">/**
 * This method currently only works for boards with not more than 2 threats
 * (&gt;70% of all boards)
 * 
 * @return estimated Value for the current board
 */</span>
<span class="kd">public</span> <span class="kt">int</span> <span class="nf">evaluate</span><span class="o">(</span><span class="kt">int</span> <span class="n">curPlayer</span><span class="o">,</span> <span class="kt">long</span> <span class="n">zobr</span><span class="o">)</span> <span class="o">{</span>
	<span class="kt">int</span> <span class="n">numThreats</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">threatsCol</span> <span class="o">=</span> <span class="mi">0</span><span class="o">,</span> <span class="n">y</span><span class="o">;</span>
	<span class="kt">long</span> <span class="n">threatsP1</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">,</span> <span class="n">threatsP2</span> <span class="o">=</span> <span class="mi">0L</span><span class="o">;</span>

	<span class="c1">// Ermittlung aller Drohungen beider Spieler!
</span>
	<span class="c1">// Außerdem Spalten markieren, in denen Drohungen
</span>
	<span class="c1">// vorhanden sind!
</span>
	<span class="k">for</span> <span class="o">(</span><span class="kt">byte</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="no">COLCOUNT</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
		<span class="n">y</span> <span class="o">=</span> <span class="n">colHeight</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
		<span class="k">while</span> <span class="o">(</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">6</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">canWin</span><span class="o">(</span><span class="no">PLAYER1</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span> <span class="o">{</span>
				<span class="n">threatsP1</span> <span class="o">|=</span> <span class="n">fieldMask</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">];</span>
				<span class="n">numThreats</span><span class="o">++;</span>
				<span class="c1">// Markiert Spalte in der Drohung ist
</span>
				<span class="n">threatsCol</span> <span class="o">|=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="o">(</span><span class="mi">6</span> <span class="o">-</span> <span class="n">i</span><span class="o">));</span>
				<span class="k">break</span><span class="o">;</span>
			<span class="o">}</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">canWin</span><span class="o">(</span><span class="no">PLAYER2</span><span class="o">,</span> <span class="n">i</span><span class="o">,</span> <span class="n">y</span><span class="o">))</span> <span class="o">{</span>
				<span class="n">threatsP2</span> <span class="o">|=</span> <span class="n">fieldMask</span><span class="o">[</span><span class="n">i</span><span class="o">][</span><span class="n">y</span><span class="o">];</span>
				<span class="n">numThreats</span><span class="o">++;</span>
				<span class="c1">// Markiert Spalte in der Drohung ist
</span>
				<span class="n">threatsCol</span> <span class="o">|=</span> <span class="o">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="o">(</span><span class="mi">6</span> <span class="o">-</span> <span class="n">i</span><span class="o">));</span>
			<span class="o">}</span>
			<span class="o">++</span><span class="n">y</span><span class="o">;</span>

			<span class="c1">// Mehr Drohungen werden sowieso nicht untersucht
</span>
			<span class="k">if</span> <span class="o">(</span><span class="n">numThreats</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
		<span class="o">}</span>
	<span class="o">}</span>

	<span class="c1">// Prüfen, wie viele Drohungen vorhanden sind
</span>
	<span class="c1">// und bei 0,1 oder 2 Drohungen Bewertung der
</span>
	<span class="c1">// Stellung ermitteln
</span>
	<span class="k">switch</span> <span class="o">(</span><span class="n">numThreats</span><span class="o">)</span> <span class="o">{</span>
	<span class="k">case</span> <span class="mi">0</span><span class="o">:</span> <span class="c1">// Wenn keiner eine Drohung hat
</span>
		<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
	<span class="k">case</span> <span class="mi">1</span><span class="o">:</span> <span class="c1">// Wenn einer der beiden Spieler eine Drohung hat
</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">threatsP2</span> <span class="o">!=</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span><span class="c1">// Wenn Spieler2 die Drohung hat
</span>
			<span class="c1">// Wenn Spieler2 eine gerade Drohung hat
</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP2</span> <span class="o">&amp;</span> <span class="no">EVENROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">500</span><span class="o">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="c1">// Wenn Spieler1 eine ungerade Drohung hat
</span>
		<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="no">ODDROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
			<span class="k">return</span> <span class="mi">500</span><span class="o">;</span>
		<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
	<span class="k">case</span> <span class="mi">2</span><span class="o">:</span> <span class="c1">// Wenn insgesamt 2 Drohungen vorhanden sind
</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">threatsP2</span> <span class="o">==</span> <span class="mi">0L</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Wenn Spieler2 keine Drohung hat
</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="no">ODDROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="k">return</span> <span class="mi">500</span><span class="o">;</span>
			<span class="k">return</span> <span class="mi">0</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="k">if</span> <span class="o">(</span><span class="n">threatsP1</span> <span class="o">==</span> <span class="mi">0L</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// Wenn Spieler1 keine Drohung hat
</span>
			<span class="c1">// Wenn Spieler2 min. eine gerade Drohung hat
</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP2</span> <span class="o">&amp;</span> <span class="no">EVENROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">500</span><span class="o">;</span>
			<span class="c1">// Befinden sich die Drohungen von Spieler2 in unterschiedlichen
</span>
			<span class="c1">// spalten
</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsCol</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">threatsCol</span> <span class="o">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="c1">// Wenn Spieler2 2 ungerade Drohungen hat
</span>
				<span class="k">if</span> <span class="o">((</span><span class="n">threatsP2</span> <span class="o">&amp;</span> <span class="no">ODDROWS</span><span class="o">)</span> <span class="o">==</span> <span class="n">threatsP2</span><span class="o">)</span>
					<span class="k">return</span> <span class="o">-</span><span class="mi">500</span><span class="o">;</span>
			<span class="k">break</span><span class="o">;</span>
		<span class="o">}</span>
		<span class="c1">// Wenn beide eine Drohung haben
</span>
		<span class="c1">// Wenn beide Drohungen in unterschiedlichen Spalten sind
</span>
		<span class="k">if</span> <span class="o">((</span><span class="n">threatsCol</span> <span class="o">&amp;</span> <span class="o">(</span><span class="n">threatsCol</span> <span class="o">-</span> <span class="mi">1</span><span class="o">))</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="no">ODDROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="k">if</span> <span class="o">((</span><span class="n">threatsP2</span> <span class="o">&amp;</span> <span class="no">ODDROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
					<span class="k">return</span> <span class="mi">0</span><span class="o">;</span> <span class="c1">// Beide haben eine ungerade Drohung
</span>
				<span class="k">else</span>
					<span class="c1">// Spieler1 hat eine ungerade und Spieler2 eine gerade
</span>
					<span class="c1">// Drohung
</span>
					<span class="k">return</span> <span class="mi">500</span><span class="o">;</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="no">EVENROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">500</span><span class="o">;</span> <span class="c1">// Spieler1 hat nur eine gerade Drohung
</span>
		<span class="o">}</span>
		<span class="c1">// Wenn beide Drohungen im gleichen Feld sind...
</span>
		<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="n">threatsP2</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
			<span class="k">if</span> <span class="o">((</span><span class="n">threatsP1</span> <span class="o">&amp;</span> <span class="no">EVENROWS</span><span class="o">)</span> <span class="o">!=</span> <span class="mi">0L</span><span class="o">)</span>
				<span class="c1">// Spieler1 und Spieler2 haben eine gerade Drohung
</span>
				<span class="k">return</span> <span class="o">-</span><span class="mi">500</span><span class="o">;</span>
			<span class="k">else</span>
				<span class="c1">// Spieler1 und Spieler2 haben eine ungerade Drohung
</span>
				<span class="k">return</span> <span class="mi">500</span><span class="o">;</span>
		<span class="k">break</span><span class="o">;</span>
	<span class="o">}</span>
	<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<hr />

<p><em>Note: Several paragraphs of this blog post are in parts taken from my <a href="http://www.gm.fh-koeln.de/~konen/research/PaperPDF/MT-Thill2015-final.pdf">Master’s thesis</a> or from a translation of my <a href="http://www.gm.fh-koeln.de/ciopwebpub/Theses.d/Thill12.d/BA-Thill-2012.pdf">Bachelor thesis</a> and <a href="http://www.gm.fh-koeln.de/ciopwebpub/Thil12a.d/Thill12a.pdf">some earlier project work</a>.</em></p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="https://MarkusThill.github.io/tags#Connect-4" title="Pages tagged Connect-4" class="tag"><span class="term">Connect-4</span></a><a href="https://MarkusThill.github.io/tags#AI" title="Pages tagged AI" class="tag"><span class="term">AI</span></a><a href="https://MarkusThill.github.io/tags#tree-search" title="Pages tagged tree-search" class="tag"><span class="term">tree-search</span></a><a href="https://MarkusThill.github.io/tags#alpha-beta" title="Pages tagged alpha-beta" class="tag"><span class="term">alpha-beta</span></a><a href="https://MarkusThill.github.io/tags#minimax" title="Pages tagged minimax" class="tag"><span class="term">minimax</span></a><a href="https://MarkusThill.github.io/tags#transposition tables" title="Pages tagged transposition tables" class="tag"><span class="term">transposition tables</span></a><a href="https://MarkusThill.github.io/tags#opening databases" title="Pages tagged opening databases" class="tag"><span class="term">opening databases</span></a><a href="https://MarkusThill.github.io/tags#move ordering" title="Pages tagged move ordering" class="tag"><span class="term">move ordering</span></a><a href="https://MarkusThill.github.io/tags#bitboards" title="Pages tagged bitboards" class="tag"><span class="term">bitboards</span></a></span>
        
        <span class="author vcard"><span class="fn">Markus Thill</span></span>
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=https://MarkusThill.github.io/programming/connect-4-final-considerations/" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=https://MarkusThill.github.io/programming/connect-4-final-considerations/" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
    <li class="googleplus"><a href="https://plus.google.com/share?url=https://MarkusThill.github.io/programming/connect-4-final-considerations/" title="Share on Google Plus"><span class="count"><i class="fa fa-google-plus-square"></i> +1</span></a></li>
  </ul>
</div><!-- /.social-share -->

      </footer>
    </div><!-- /.entry-content -->
    <div class="read-more">
  <div class="read-more-header">
    <a href="https://MarkusThill.github.io/markus" class="read-more-btn">About the Author</a>
  </div><!-- /.read-more-header -->
  <div class="read-more-content author-info">
    <h3>Markus Thill</h3>
    <div class="author-container">
      <img class="author-img" src="https://MarkusThill.github.io/images/avatar.jpg" alt="Markus Thill" />
      <div class="author-bio">I studied computer engineering (B.Sc.) and Automation & IT (M.Eng.). Generally, I am interested in machine learning (ML) approaches (in the broadest sense), but particularly in the fields of time series analysis, anomaly detection, Reinforcement Learning (e.g. for board games), Deep Learning (DL) and incremental (on-line) learning procedures. </div>
    </div>
    <div class="author-share">
      <ul class="list-inline social-buttons">
        
          <li><a href="https://github.com/markusthill" target="_blank"><i class="fa fa-github fa-fw"></i></a></li>
        
          <li><a href="https://www.linkedin.com/in/markus-thill-a4991090/" target="_blank"><i class="fa fa-linkedin fa-fw"></i></a></li>
        
      </ul>
      
        <a aria-label="Follow @MarkusThill on GitHub" data-size="large" href="https://github.com/MarkusThill" class="github-button">Follow @MarkusThill</a>
      
      <br>
      
    </div>
  </div>
</div>

    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="https://MarkusThill.github.io/programming/connect-4-opening-databases/" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="https://MarkusThill.github.io/deriving-a-closed-form-solution-of-the-fibonacci-sequence/" title="Deriving a Closed-Form Solution of the Fibonacci Sequence using the Z-Transform">Deriving a Closed-Form Solution of the Fibonacci Sequence using the Z-Transform</a></h3>
      <p>The Fibonacci sequence might be one of the most famous sequences in the field of mathmatics and computer science. Already high school stu...&hellip; <a href="https://MarkusThill.github.io/deriving-a-closed-form-solution-of-the-fibonacci-sequence/">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="https://MarkusThill.github.io/derivation-of-a-weighted-recursive-least-squares-estimator/" title="Derivation of a Weighted Recursive Linear Least Squares Estimator">Derivation of a Weighted Recursive Linear Least Squares Estimator</a></h4>
        <span>Published on May 05, 2019</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="https://MarkusThill.github.io/gaussian-distribution-with-a-diagonal-covariance-matrix/" title="Gaussian Distribution With a Diagonal Covariance Matrix">Gaussian Distribution With a Diagonal Covariance Matrix</a></h4>
        <span>Published on May 04, 2019</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="https://MarkusThill.github.io/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script type="text/javascript" src="https://MarkusThill.github.io/assets/js/scripts.min.js"></script>
<script type="text/javascript" async defer id="github-bjs" src="https://buttons.github.io/buttons.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^https:/.test(d.location)?'https':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>



<!-- Asynchronous Google Analytics snippet -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-113918188-1', 'auto');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'markusthill-github-io'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>




<script type="text/javascript">
    sharing();
</script>



<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2019 Markus Thill. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="https://github.com/aron-bordin/neo-hpstr-jekyll-theme" rel="nofollow">Neo-HPSTR Theme</a>.</span>

  </footer>
</div><!-- /.footer-wrapper -->

</body>
</html>
